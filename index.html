<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Hadoop : Loading CSV Data Into Hive" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Hadoop</title>
  </head>

  <body>

<a href="https://github.com/michaelprom/Hadoop/hive">http://www.infochimps.com/datasets/nyse-daily

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/michaelprom/Hadoop">View on GitHub</a>

          <h1 id="project_title">Hadoop</h1>
          <h2 id="project_tagline">Loading CSV Data Into Hive</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/michaelprom/Hadoop/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/michaelprom/Hadoop/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="loading-csv-data-into-hive" class="anchor" href="#loading-csv-data-into-hive"><span class="octicon octicon-link"></span></a>Loading CSV Data Into Hive</h1>

<p>Michael Prom 
11/16/2013</p>

<h3>
<a name="this-how-to-will-show-you-how-to-load-csv-data-into-hive" class="anchor" href="#this-how-to-will-show-you-how-to-load-csv-data-into-hive"><span class="octicon octicon-link"></span></a>This how to will show you how to load csv data into Hive.</h3>

<hr><p>For those who are more familar with SQL based queries. HIVE is built on top of the Hadoop framework to help with querying large amounts of data. HiveQL is very much similar to SQL. By loading data into Hive you can perform queries as you would using SQL but using data that resides in HDFS. </p>

<h2>
<a name="loading-data" class="anchor" href="#loading-data"><span class="octicon octicon-link"></span></a>Loading Data</h2>

<p>The data I have is taken from <a href="http://www.infochimps.com/datasets/nyse-daily-1970-2010-open-close-high-low-and-volume">http://www.infochimps.com/datasets/nyse-daily-1970-2010-open-close-high-low-and-volume</a>.  There is the schema of the file along with one record:</p>

<pre><code>exchange,stock_symbol,date,stock_price_open,stock_price_high,stock_price_low,stock_price_close,stock_volume,stock_price_adj_close
NYSE,EXI,2010-02-08,43.04,43.06,42.45,42.51,53000,42.51
</code></pre>

<h2>
<a name="using-the-hive-shell" class="anchor" href="#using-the-hive-shell"><span class="octicon octicon-link"></span></a>Using the Hive Shell</h2>

<p>The first step is to get into the Hive Shell. All you need to do is type in "Hive"</p>

<pre><code>Logging initialized using configuration in jar:file:/opt/cloudera/parcels/CDH-4.4.0-1.cdh4.4.0.p0.39/lib/hive/lib/hive-common-0.10.0-cdh4.4.0.jar!/hive-log4j.properties
Hive history file=/tmp/prom9473/hive_job_log_53331a21-cac3-423b-9573-211c1883f7e9_2102019621.txt
hive&gt;
</code></pre>

<p>You will see the hive prompt. You can now continue with your commands.</p>

<h2>
<a name="create-table" class="anchor" href="#create-table"><span class="octicon octicon-link"></span></a>Create Table</h2>

<p>The first step in loading data into hive is creating a table which you will load your csv data. In this example I create a table called nyse followed by the column name and type. </p>

<pre><code>CREATE TABLE nyse(exchange string,stock_symbol string ,`date` timestamp,stock_price_open double,stock_price_high double,stock_price_low double,stock_price_close double,stock_volume bigint,stock_price_adj_close double) ROW FORMAT DELIMITED FIELDS TERMINATED BY ','
</code></pre>

<p>You will need to the row format to be delimited by ','.  <strong>Note:</strong> date is a reserved word in Hive. To use a reserved word place ` around the word. For example:</p>

<pre><code>`date`  
</code></pre>

<p>Now execute the CREATE TABLE Statement.</p>

<pre><code>hive&gt; CREATE TABLE nyse(exchange string,stock_symbol string ,`date` timestamp,stock_price_open double,stock_price_high double,stock_price_low double,stock_price_close double,stock_volume bigint,stock_price_adj_close double) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',';
OK
Time taken: 0.347 seconds
</code></pre>

<p>Each line should end with a semicolon to note that it is the end of line. Here I've executed a show tables to show all the tables within my instance of Hive. (I created the nasdaq one earlier). </p>

<pre><code>hive&gt; show tables;
nasdaq
nyse
Time taken: 1.837 seconds
</code></pre>

<h2>
<a name="load-the-data" class="anchor" href="#load-the-data"><span class="octicon octicon-link"></span></a>Load The Data</h2>

<p>Now that the table is created. You can now load the CSV data into hive. The data is outside of HDFS in my nyse directory.</p>

<pre><code> LOAD DATA LOCAL INPATH '/home/user/infochimps_dataset_4777_download_16185-csv/infochimps_dataset_4777_download_16185/NYSE/*.csv' INTO TABLE nyse;
</code></pre>

<h2>
<a name="querying-the-data" class="anchor" href="#querying-the-data"><span class="octicon octicon-link"></span></a>Querying the Data</h2>

<p>Now that the data is loaded into Hive (HDFS). You can run your queries. </p>

<pre><code>select distinct stock_symbol from nasdaq where stock_price_close &gt; 50;

ZOLT
ZRAN
ZUMZ
Time taken: 20.849 seconds
</code></pre>

<h2>
<a name="references" class="anchor" href="#references"><span class="octicon octicon-link"></span></a>References</h2>

<p>Dataset</p>

<p>NYSE Daily 1970-2010 Open, Close, High, Low and Volume  Added By Infochimps 
<a href="http://www.infochimps.com/datasets/nyse-daily-1970-2010-open-close-high-low-and-volume">http://www.infochimps.com/datasets/nyse-daily-1970-2010-open-close-high-low-and-volume</a></p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Hadoop maintained by <a href="https://github.com/michaelprom">michaelprom</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
